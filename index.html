<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>



  <title>George's Rental Management System</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <main>
  <!-- LOGIN SECTION -->
<section id="login-section" >
  <h2>Login</h2>

  <form id="login-form">
       <div id="login-loading" style="display:none; margin-top:10px;">
       <span class="spinner"></span> Logging in...
       </div>
      <p id="login-error" style="color:red; margin-top:10px; display:none;"></p>


    <label for="username">Username:</label>
    <input type="text" id="username" name="username" required />

    <label for="password">Password:</label>
    <div class="password-wrapper">
      <input type="password" id="password" name="password" required />
      <i class="fa-solid fa-eye toggle-password" id="toggle-password"></i>
    </div>

    <a href="#" class="forgot-password" id="forgot-password-link">Forgot password?</a>

    

    <button type="submit">Login</button>
    <div class="divider">or</div>
    

    <!-- Dummy Google Login -->
    <button type="button" id="google-login-btn" class="google-btn">
      <img src="google-icon.jpg" alt="Google logo" style="height: 20px; width: 20px; margin-right: 8px;">
      Log in with Google
    </button>

    <div id="user-info" style="margin-top:20px; display:none;">
      <img id="user-pic" style="border-radius:50%; width:50px; height:50px;"><br>
      <span id="user-name"></span><br>
      <span id="user-email"></span>
    </div>

    <!-- Email Signup -->
    <button type="button" id="email-signup-btn" class="email-btn">
      Sign up with Email
    </button>
  </form>

  <div id="otp-section" style="display:none; margin-top:20px;">
  <h3>Enter OTP</h3>
  <input type="text" id="otp-code" placeholder="......" maxlength="6">
  <br>
  <button type="button" id="otp-submit-btn">Verify OTP</button>
  <p id="otp-error" style="display:none;"></p>
</div>

</section>
<!-- FORGOT PASSWORD SECTION -->
<section id="forgot-password-section" style="display:none;">
  <h2>Reset Password</h2>
  <p>Enter your email address to reset your password:</p>
  <input type="email" id="reset-email" placeholder="Enter your email" required>
  <button id="reset-btn" type="button">Reset Password</button>
  <p id="reset-message" style="margin-top:10px; color:green;"></p>

  <p><a href="#" id="back-to-login">Back to Login</a></p>
</section>
<!-- EMAIL SIGNUP SECTION -->
<section id="email-signup-section" class="auth-section" style="display: none;">
  <h2>Create Account</h2>
  <form id="email-signup-form">
    <label for="signup-email">Email:</label>
    <input type="email" id="signup-email" required />

    <label for="signup-password">Password:</label>
    <div class="password-wrapper">
      <input type="password" id="signup-password" required />
      <i class="fa-solid fa-eye toggle-password"></i>
    </div>

    <label for="signup-confirm-password">Confirm Password:</label>
    <div class="password-wrapper">
      <input type="password" id="signup-confirm-password" required />
      <i class="fa-solid fa-eye toggle-password"></i>
    </div>

    <button type="submit">Sign Up</button>

    <p class="switch-form">
      Already have an account? 
      <a href="#" id="back-to-login-email">Login</a>
    </p>
  </form>
</section>



    <!-- DASHBOARD SECTION -->
    <section id="dashboard-section" style="display: none;">
      <div class="layout">
        <!-- Sidebar -->
<div class="sidebar">
  <h2>GRPMS</h2>
  <ul>
    <li id="nav-dashboard">Dashboard</li>
    <li id="nav-tenants">Current Tenants</li>
    <li id="nav-payments">Payments</li>
    <li id="nav-reports">Reports</li>
    <li id="nav-messages">
      âœ‰Messages <span id="newMessageCount" class="badge"></span>
    </li>
  </ul>
</div>

        


        <!-- Main Content -->
        <div class="main">
          
          <!-- DASHBOARD -->
          <section id="dashboard-content">
            <div class="card-container">
              <div class="card">
                <h3>Total Tenants</h3>
                <p id="tenant-count">0</p>
              </div>
              <div class="card">
                <h3>Total Rent Collected</h3>
                <p id="total-rent">KSh 0</p>
              </div>
              <div class="card">
                <h3>Outstanding Balance</h3>
                <p id="balance-due">KSh 0</p>
              </div>
            </div>
            <div class="charts">
              <div class="chart-container">
                <h4>Payment Activity</h4>
                <canvas id="paymentsChart"></canvas>
              </div>
              <div class="chart-container">
                <h4>Balance Trend</h4>
                <canvas id="balanceChart"></canvas>
              </div>
            </div>
          </section>

          <!-- TENANTS -->
          <section id="tenant-section" style="display: none;">
            <h2>Current Tenants</h2>

            <div class="tenant-controls" style="margin-bottom: 1rem; display: flex; gap: 1rem;">
               <input type="text" id="tenantSearch" placeholder="Search by name..." style="padding: 6px; border: 1px solid #ccc; border-radius: 6px; flex: 1;">
    
                <select id="tenantFilter" style="padding: 6px; border: 1px solid #ccc; border-radius: 6px;">
                <option value="all">All</option>
                        <option value="paid">Paid</option>
                        <option value="unpaid">Unpaid</option>
                 </select>
               </div>
            <table class="tenants-table">
              <thead>
                <tr>
                  <th> Name</th>
                  <th>House No.</th>
                  <th>Rent Amount</th>
                  <th>Last Payment</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="tenants-body"></tbody>
            </table>
            <button id="addTenantBtn">Add Tenant</button>
            
          </section>

          <!-- PAYMENTS -->
         <section id="payment-section" style="display: none;">
  <h2>Payment Management</h2>

  <!-- ===== Payment Entry Form ===== -->
  <form id="payment-form" class="payment-form">
    <label for="tenant-select">Tenant:</label>
    <select id="tenant-select" required>
      <option value="">-- Select Tenant --</option>
      <!-- Dynamically populated with tenant names -->
    </select>

    <label for="payment-method">Payment Method:</label>
    <select id="payment-method" required>
      <option value="">-- Select Method --</option>
      <option value="Cash">Cash</option>
      <option value="Bank">Bank Transfer</option>
      <option value="Mobile Money">Mobile Money</option>
    </select>

    <label for="payment-amount">Amount:</label>
    <input type="number" id="payment-amount" min="0" step="0.01" required />

    <label for="payment-date">Date:</label>
    <input type="date" id="payment-date" required />

    <label for="rent-period">Rent Period:</label>
    <input type="month" id="rent-period" required />

    <label for="payment-ref">Reference Number:</label>
    <input type="text" id="payment-ref" placeholder="e.g. MPESA123ABC" />

    <label for="payment-notes">Notes:</label>
    <textarea id="payment-notes" rows="2" placeholder="Optional"></textarea>

    <button type="submit">Add Payment</button>
  </form>

  <hr />

  <!-- ===== Payment Records Table ===== -->
  <h3>Payment Records</h3>
  <input type="text" id="search-payments" placeholder="Search by tenant or reference..." />

  <table class="payments-table">
    <thead>
      <tr>
        <th>Tenant Name</th>
        <th>Amount</th>
        <th>Date</th>
        <th>Method</th>
        <th>Reference</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="payments-body">
      <!-- Payment rows will be injected here -->
    </tbody>
  </table>
  <!-- ===== Tenant Balances ===== -->
<h3>Tenant Balances</h3>
<table class="balances-table">
  <thead>
    <tr>
      <th>Tenant</th>
      <th>Rent Due</th>
      <th>Total Paid</th>
      <th>Balance</th>
    </tr>
  </thead>
  <tbody id="balances-body"></tbody>
</table>
</section>


          
          <!-- REPORTS -->
           <section id="report-section" style="display:none;">
  <h2>Reports</h2>

  <!-- Filters -->
  <div id="report-filters">
    <label for="report-start-date">Start Date:</label>
    <input type="date" id="report-start-date">

    <label for="report-end-date">End Date:</label>
    <input type="date" id="report-end-date">

    <label for="report-method">Method:</label>
    <select id="report-method">
      <option value="">All</option>
      <option value="M-Pesa">M-Pesa</option>
      <option value="Bank">Bank</option>
      <option value="Cash">Cash</option>
    </select>

    <button id="apply-report-filters">Apply</button>
  </div>

  <!-- Totals Table -->
  <table class="reports-table">
    <thead>
      <tr><th>Metric</th><th>Value</th></tr>
    </thead>
    <tbody>
      <tr><td>Total Tenants</td><td id="report-tenant-count">0</td></tr>
      <tr><td>Total Rent Collected</td><td id="report-rent">KSh 0</td></tr>
      <tr><td>Outstanding Balances</td><td id="report-due">KSh 0</td></tr>
    </tbody>
  </table>

  <!-- Breakdown -->
  <h3>Breakdown by Payment Method</h3>
  <table id="method-breakdown">
    <thead>
      <tr>
        <th>Method</th>
        <th>Amount (KSh)</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>M-Pesa</td><td id="mpesa-total">KSh 0</td></tr>
      <tr><td>Bank</td><td id="bank-total">KSh 0</td></tr>
      <tr><td>Cash</td><td id="cash-total">KSh 0</td></tr>
    </tbody>
  </table>

  <!-- Chart placeholders (we'll wire them later) -->
<h3>Visuals</h3>
<div class="report-charts">
  <div class="report-chart-container">
    <canvas id="reportPieChart"></canvas>
  </div>
  <div class="report-chart-container">
    <canvas id="reportBarChart"></canvas>
  </div>
</div>



<!-- Export Buttons -->
<div class="export-buttons">
  <button id="export-csv-btn">Export CSV</button>
  <button id="export-pdf-btn">Export PDF</button>
</div>


</section>



          <!-- MESSAGES -->
         <!-- Messages Section -->
<section id="messages-section" style="display: none;">
  <h2>Tenant Communication</h2>

  <!-- Tabs -->
  <div class="messages-tabs">
    <button id="inboxBtn" class="tab-btn active">Inbox</button>
    <button  id="outboxBtn"  class="tab-btn">Outbox</button>
  </div>

  <!-- Search -->
  <div class="messages-search">
    <input type="text" id="searchMessages" placeholder="Search messages...">
  </div>

  <!-- Inbox -->
  <div id="inbox" class="messages-list">
    <!-- Messages will load here -->
  </div>

  <!-- Outbox -->
  <div id="outbox" class="messages-list" style="display:none;">
    <!-- Messages will load here -->
  </div>

  <!-- Compose Form -->
<!-- Compose Form -->
<form id="messageForm" class="compose-form">
  <label id="messageLabel" for="messageInput">Compose Message:</label>
  <textarea id="messageInput" rows="3" placeholder="Type your message here..." required></textarea>

  <!-- Role selector -->
  <label for="senderRole">I am:</label>
  <select id="senderRole">
    <option value="Landlord">Landlord</option>
    <option value="Tenant">Tenant</option>
  </select>

  <button type="submit">Send</button>
</form>

</section>

  </main>

  <!-- MODAL -->
  <div id="addTenantModal" class="modal">
    <div class="modal-content">
      <span class="close-button" id="closeModal">&times;</span>
      <h2>Add New Tenant</h2>
      <form id="addTenantForm">
        <label for="tenantName">Name:</label>
        <input type="text" id="tenantName" required>
        <label for="houseNumber">House Number:</label>
        <input type="text" id="houseNumber" required>
        <label for="rentAmount">Rent Amount (KSh):</label>
        <input type="number" id="rentAmount" required>
        <label for="lastPayment">Last Payment Date:</label>
        <input type="date" id="lastPayment" required>
        <button type="submit">Add Tenant</button>
      </form>
    </div>
  </div>




  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <script src="script.js"></script>
</body>
</html>
